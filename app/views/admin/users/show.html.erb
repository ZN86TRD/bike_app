<div class="container mt-5">
  <div class="row">
    <div class="col-md-10 mx-auto">
      <h2 class="mb-4 bg-light p-2 border-start border-4 border-primary"><%= @user.name %>さんの詳細</h2>

      <div class="card shadow-sm mb-5">
        <div class="card-header bg-white">
          <h5 class="mb-0">登録情報</h5>
        </div>
        <div class="card-body">
          <div class="row mb-3">
            <div class="col-sm-3 fw-bold">ユーザーID</div>
            <div class="col-sm-9"><%= @user.id %></div>
          </div>
          <div class="row mb-3">
            <div class="col-sm-3 fw-bold">氏名</div>
            <div class="col-sm-9"><%= @user.name %></div>
          </div>
          <div class="row mb-3">
            <div class="col-sm-3 fw-bold">メールアドレス</div>
            <div class="col-sm-9"><%= @user.email %></div>
          </div>
          <div class="row mb-3">
            <div class="col-sm-3 fw-bold">登録日</div>
            <div class="col-sm-9"><%= @user.created_at.strftime('%Y/%m/%d %H:%M') %></div>
          </div>
          
          <div class="row mb-3">
            <div class="col-sm-3 fw-bold">ステータス</div>
            <div class="col-sm-9">
              <% if @user.is_active %>
                <span class="badge rounded-pill bg-success">有効</span>
              <% else %>
                <span class="badge rounded-pill bg-secondary">退会済み</span>
              <% end %>
            </div>
          </div>

          <div class="text-right mt-3">
            <% if @user.is_active && @user.email != 'guest@example.com' %>
              <%= link_to "退会させる", admin_user_path(@user), method: :patch, data: { confirm: "本当にこのユーザーを退会処理しますか？" }, class: "btn btn-danger px-4 ms-2" %>
            <% end %>
              <%= link_to "一覧へ戻る", admin_users_path, class: "btn btn-outline-secondary ms-2" %>
          </div>
        </div>
      </div>

      <h3 class="mb-3">投稿履歴 (<%= @user.posts.count %>)</h3>
      <div class="card shadow-sm">
        <table class="table mb-0">
          <thead class="table-light">
            <tr>
              <th>投稿ID</th>
              <th>タイトル</th>
              <th>投稿日</th>
              <th>アクション</th>
            </tr>
          </thead>
          <tbody>
            <% @posts.each do |post| %>
              <tr>
                <td><%= post.id %></td>
                <td><%= post.title %></td>
                <td><%= post.created_at.strftime('%Y/%m/%d') %></td>
                <td>
                  <%= link_to "詳細", admin_post_path(post), class: "btn btn-sm btn-outline-primary" %>
                </td>
              </tr>
            <% end %>
            <% if @user.posts.empty? %>
              <tr>
                <td colspan="4" class="text-center text-muted p-4">投稿はありません</td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
      <div class="d-flex justify-content-center mt-3">
        <%= paginate @posts %>
      </div>
    </div>
  </div>
</div>
